# Secure File Manager

–ë–µ–∑–æ–ø–∞—Å–Ω—ã–π —Ñ–∞–π–ª–æ–≤—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö PostgreSQL, —Ä–µ–∞–ª–∏–∑—É—é—â–∏–π –∑–∞—â–∏—Ç—É –æ—Ç –æ—Å–Ω–æ–≤–Ω—ã—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π.

## üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–ö–æ–Ω—Å–æ–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ñ–∞–π–ª–∞–º–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ (—Ç–µ–∫—Å—Ç–æ–≤—ã–µ, JSON, XML, ZIP-–∞—Ä—Ö–∏–≤—ã) —Å –∞–∫—Ü–µ–Ω—Ç–æ–º –Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ —Ä–∞–±–æ—Ç—É —Å —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö.

## üéØ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### 1. **Path Traversal Protection** (–ó–∞—â–∏—Ç–∞ –æ—Ç –æ–±—Ö–æ–¥–∞ –ø—É—Ç–µ–π)
- –í—Å–µ —Ñ–∞–π–ª–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã sandbox-–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–µ–π
- –§—É–Ω–∫—Ü–∏—è `ResolvePath()` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∏ –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –ø—É—Ç–∏
- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Ñ–∞–π–ª–∞–º –≤–Ω–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏

**–ì–¥–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:** `fs/safety.go`

```go
// –ü—Ä–∏–º–µ—Ä: –ø–æ–ø—ã—Ç–∫–∞ "../../../etc/passwd" –±—É–¥–µ—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞
safePath, err := ResolvePath(userPath)
```

### 2. **Insecure Deserialization Protection** (–ó–∞—â–∏—Ç–∞ –æ—Ç –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ–π –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ Go (`encoding/json`, `encoding/xml`)
- Go –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∫–æ–¥ –ø—Ä–∏ –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ (–≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –¥—Ä—É–≥–∏—Ö —è–∑—ã–∫–æ–≤)
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ

**–ì–¥–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:** `fs/structured.go`

### 3. **ZIP Bomb Protection** (–ó–∞—â–∏—Ç–∞ –æ—Ç ZIP-–±–æ–º–±)
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ —Ä–∞—Å–ø–∞–∫–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (100 MB)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ compression ratio (–º–∞–∫—Å–∏–º—É–º 100:1)
- –ó–∞—â–∏—Ç–∞ –æ—Ç Zip Slip –∞—Ç–∞–∫–∏ (path traversal –≤–Ω—É—Ç—Ä–∏ –∞—Ä—Ö–∏–≤–∞)
- LimitReader –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤

**–ì–¥–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:** `fs/archive.go`

```go
const (
    MaxDecompressedSize = 100 * 1024 * 1024 // 100 MB
    MaxCompressionRatio = 100               // 100:1
)
```

### 4. **Race Conditions Protection** (–ó–∞—â–∏—Ç–∞ –æ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è –≥–æ–Ω–∫–∏)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `sync.RWMutex` –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª–∞–º
- Read locks –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π —á—Ç–µ–Ω–∏—è (–Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ—Ç–æ–∫–æ–≤ –º–æ–≥—É—Ç —á–∏—Ç–∞—Ç—å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ)
- Write locks –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π –∑–∞–ø–∏—Å–∏ (—ç–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–π –¥–æ—Å—Ç—É–ø)

**–ì–¥–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:** `fs/operations.go`

```go
var fileMutex sync.RWMutex

// –ß—Ç–µ–Ω–∏–µ
fileMutex.RLock()
defer fileMutex.RUnlock()

// –ó–∞–ø–∏—Å—å
fileMutex.Lock()
```

### 5. **Timing Attack Protection** (–ó–∞—â–∏—Ç–∞ –æ—Ç —Ç–∞–π–º–∏–Ω–≥-–∞—Ç–∞–∫)
- –ü—Ä–∏ –ª–æ–≥–∏–Ω–µ –≤—Å–µ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ö–µ—à–∞ (–¥–∞–∂–µ –¥–ª—è –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
- –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–æ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö (–±–µ–∑ —É—Ç–µ—á–∫–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏)

**–ì–¥–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:** `main.go` (—Ñ—É–Ω–∫—Ü–∏—è `login`)

```go
// –ó–∞—â–∏—Ç–∞ –æ—Ç —Ç–∞–π–º–∏–Ω–≥-–∞—Ç–∞–∫–∏: –≤—Å–µ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É —Ö–µ—à–∞
if user == nil {
    auth.CheckPasswordHash(password, "$2a$14$dummy.hash...")
    fmt.Println("Invalid username or password")
    return
}
```

### 6. **Input Validation** (–í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: 3-30 —Å–∏–º–≤–æ–ª–æ–≤, —Ç–æ–ª—å–∫–æ –±—É–∫–≤—ã/—Ü–∏—Ñ—Ä—ã/_
- –ó–∞–ø—Ä–µ—Ç —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª–æ–≤: `..`, `/`, `\` –≤ username
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–ª–∏–Ω—ã –ø–∞—Ä–æ–ª—è: 8-72 —Å–∏–º–≤–æ–ª–∞ (–ª–∏–º–∏—Ç bcrypt)

**–ì–¥–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:** `main.go` (—Ñ—É–Ω–∫—Ü–∏—è `validateUsername`)

```go
var usernameRegex = regexp.MustCompile(`^[a-zA-Z0-9_]{3,30}$`)
```

### 7. **Encapsulated State** (–ò–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è)
- –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –æ–±—ë—Ä–Ω—É—Ç–æ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—É `App`
- –ù–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
- –£–ª—É—á—à–µ–Ω–Ω–∞—è —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å

**–ì–¥–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:** `main.go`

```go
type App struct {
    currentUser *db.User
    currentDir  string
    cfg         *config.Config
}
defer fileMutex.Unlock()
```

### 5. **SQL Injection Protection** (–ó–∞—â–∏—Ç–∞ –æ—Ç SQL-–∏–Ω—ä–µ–∫—Ü–∏–π)
- –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç Prepared Statements
- –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã —Å –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä–∞–º–∏ `$1, $2, ...`
- –ù–∏–∫–∞–∫–∞—è –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è —Å—Ç—Ä–æ–∫ SQL –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

**–ì–¥–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:** `db/users.go`, `db/files.go`, `db/logs.go`

```go
stmt, err := DB.Prepare("SELECT * FROM users WHERE username = $1")
stmt.QueryRow(username)
```

### 6. **Password Security** (–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø–∞—Ä–æ–ª–µ–π)
- –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º bcrypt
- Cost factor = 14 (–≤—ã—Å–æ–∫–∞—è —Å—Ç–æ–π–∫–æ—Å—Ç—å)
- –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –ø–∞—Ä–æ–ª—è 8 —Å–∏–º–≤–æ–ª–æ–≤

**–ì–¥–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:** `auth/auth.go`

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
secure-fm/
‚îú‚îÄ‚îÄ main.go                 # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞, –º–µ–Ω—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ auth/
‚îÇ   ‚îî‚îÄ‚îÄ auth.go            # –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª–µ–π (bcrypt)
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îî‚îÄ‚îÄ config.go          # –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ db/
‚îÇ   ‚îú‚îÄ‚îÄ db.go              # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î, —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü
‚îÇ   ‚îú‚îÄ‚îÄ users.go           # CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ files.go           # CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏ —Ñ–∞–π–ª–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ logs.go            # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îú‚îÄ‚îÄ fs/
‚îÇ   ‚îú‚îÄ‚îÄ safety.go          # –ó–∞—â–∏—Ç–∞ –æ—Ç Path Traversal
‚îÇ   ‚îú‚îÄ‚îÄ operations.go      # –ë–∞–∑–æ–≤—ã–µ —Ñ–∞–π–ª–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (CRUD)
‚îÇ   ‚îú‚îÄ‚îÄ archive.go         # –†–∞–±–æ—Ç–∞ —Å ZIP (–∑–∞—â–∏—Ç–∞ –æ—Ç ZIP-–±–æ–º–±)
‚îÇ   ‚îú‚îÄ‚îÄ structured.go      # –†–∞–±–æ—Ç–∞ —Å JSON/XML
‚îÇ   ‚îú‚îÄ‚îÄ safety_test.go     # –¢–µ—Å—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø—É—Ç–µ–π
‚îÇ   ‚îî‚îÄ‚îÄ archive_test.go    # –¢–µ—Å—Ç—ã –∞—Ä—Ö–∏–≤–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îî‚îÄ‚îÄ input.go           # –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è –≤–≤–æ–¥–∞ –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ Dockerfile             # –û–±—Ä–∞–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ docker-compose.yml     # –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è (app + PostgreSQL)
‚îú‚îÄ‚îÄ go.mod                 # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Go
‚îî‚îÄ‚îÄ sandbox_data/          # –†–∞–±–æ—á–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è —Ñ–∞–π–ª–æ–≤ (—Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
```

## üóÑÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü–∞ `users`
```sql
CREATE TABLE users (
    id SERIAL PRIMARY KEY,
    username VARCHAR(50) NOT NULL UNIQUE,
    password_hash TEXT NOT NULL
);
```
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –•—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –ø–∞—Ä–æ–ª—è–º–∏

### –¢–∞–±–ª–∏—Ü–∞ `files`
```sql
CREATE TABLE files (
    id SERIAL PRIMARY KEY,
    filename VARCHAR(255) NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    size BIGINT,
    location TEXT,
    owner_id INT REFERENCES users(id)
);
```
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª–æ–≤ (–∏–º—è, —Ä–∞–∑–º–µ—Ä, –≤–ª–∞–¥–µ–ª–µ—Ü)

### –¢–∞–±–ª–∏—Ü–∞ `operations`
```sql
CREATE TABLE operations (
    id SERIAL PRIMARY KEY,
    timestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    operation_type VARCHAR(50),
    file_id INT REFERENCES files(id),
    user_id INT REFERENCES users(id)
);
```
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ñ—É—Ä–Ω–∞–ª –∞—É–¥–∏—Ç–∞ –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

## üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Docker
- Docker Compose

### –®–∞–≥–∏ –∑–∞–ø—É—Å–∫–∞

1. **–ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**
```bash
git clone <repository-url>
cd secure-fm
```

2. **–ó–∞–ø—É—Å—Ç–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ**
```bash
docker-compose up -d db
```

3. **–ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–º —Ä–µ–∂–∏–º–µ**
```bash
docker-compose run --rm app
```

> ‚ö†Ô∏è **–í–∞–∂–Ω–æ:** –î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **–∞–Ω–≥–ª–∏–π—Å–∫–∏–µ —Å–∏–º–≤–æ–ª—ã** –¥–ª—è –∏–º–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Ñ–∞–π–ª–æ–≤ (–∏–∑-–∑–∞ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–µ–π –∫–æ–¥–∏—Ä–æ–≤–∫–∏ Windows ‚Üí Docker).

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–± (–ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞ + –∑–∞–ø—É—Å–∫)
```bash
docker-compose up --build -d && docker-compose run --rm app
```

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–ù–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –≤ `docker-compose.yml`:

```yaml
environment:
  - DB_HOST=db              # –•–æ—Å—Ç PostgreSQL
  - DB_PORT=5432            # –ü–æ—Ä—Ç PostgreSQL
  - DB_USER=postgres        # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ë–î
  - DB_PASSWORD=secret      # –ü–∞—Ä–æ–ª—å –ë–î
  - DB_NAME=securefm        # –ò–º—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
  - SANDBOX_PATH=/app/sandbox  # –ü—É—Ç—å –∫ —Ä–∞–±–æ—á–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
```

## üìñ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### 1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –≤—Ö–æ–¥

–ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ:
```
--- Auth Menu ---
1. Login
2. Register
3. Exit
Select option: 2

Username: admin
Password: ********
Registration successful! Please login.
```

### 2. –û—Å–Ω–æ–≤–Ω–æ–µ –º–µ–Ω—é

–ü–æ—Å–ª–µ –≤—Ö–æ–¥–∞ –¥–æ—Å—Ç—É–ø–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏:

```
--- Main Menu ---
üë§ User: admin
üìÇ Current directory: /.
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
0. Change Directory (cd)           # –°–º–µ–Ω–∞ —Ç–µ–∫—É—â–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
1. List Drives / System Info       # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–∏—Å–∫–∞—Ö (—Ä–∞–∑–º–µ—Ä, —Å–≤–æ–±–æ–¥–Ω–æ)
2. List Directory                  # –°–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
3. Create Directory                # –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –ø–∞–ø–∫–∏
4. Read File                       # –ß—Ç–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞
5. Write File                      # –ó–∞–ø–∏—Å—å —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞
6. Delete File                     # –£–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞
7. Copy File                       # –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞
8. Move File                       # –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ/–ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞
9. Read JSON                       # –ß—Ç–µ–Ω–∏–µ JSON —Ñ–∞–π–ª–∞
10. Write JSON                     # –ó–∞–ø–∏—Å—å JSON —Ñ–∞–π–ª–∞
11. Read XML                       # –ß—Ç–µ–Ω–∏–µ XML —Ñ–∞–π–ª–∞
12. Write XML                      # –ó–∞–ø–∏—Å—å XML —Ñ–∞–π–ª–∞
13. Create ZIP                     # –°–æ–∑–¥–∞–Ω–∏–µ ZIP –∞—Ä—Ö–∏–≤–∞
14. Extract ZIP                    # –†–∞—Å–ø–∞–∫–æ–≤–∫–∞ ZIP –∞—Ä—Ö–∏–≤–∞
15. Edit/Append File               # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –≤ –∫–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞
16. Logout                         # –í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã
```

> üí° –ö–∞–∂–¥–∞—è –∫–æ–º–∞–Ω–¥–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–¥—Å–∫–∞–∑–∫–∏ —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è!

### 3. –ü—Ä–∏–º–µ—Ä—ã –æ–ø–µ—Ä–∞—Ü–∏–π

#### –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞
```
Select option: 4
Path: test.txt
Content: Hello, World!
File written successfully
```

#### –°–æ–∑–¥–∞–Ω–∏–µ JSON —Ñ–∞–π–ª–∞
```
Select option: 9
Path: data.json
Key: name
Value: John Doe
JSON written
```

#### –°–æ–∑–¥–∞–Ω–∏–µ ZIP –∞—Ä—Ö–∏–≤–∞
```
Select option: 12
Source Dir/File: test.txt
Dest Zip Path: archive.zip
Zip created
```

#### –†–∞—Å–ø–∞–∫–æ–≤–∫–∞ ZIP –∞—Ä—Ö–∏–≤–∞
```
Select option: 13
Zip Path: archive.zip
Dest Dir: extracted/
Zip extracted
```

## üîí –ü—Ä–∏–º–µ—Ä—ã –∑–∞—â–∏—Ç—ã –æ—Ç –∞—Ç–∞–∫

### Path Traversal
```
Path: ../../../etc/passwd
Error: access denied: path traversal attempt
```

### ZIP Bomb
```
Zip Path: malicious.zip
Error: zip bomb detected: compression ratio too high
```

### SQL Injection
```
Username: admin' OR '1'='1
# –ë–µ–∑–æ–ø–∞—Å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ prepared statements
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤:
```bash
go test ./fs/...
```

–¢–µ—Å—Ç—ã –≤–∫–ª—é—á–∞—é—Ç:
- `fs/safety_test.go` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞—â–∏—Ç—ã –æ—Ç path traversal
- `fs/archive_test.go` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã —Å –∞—Ä—Ö–∏–≤–∞–º–∏

## üì¶ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```go
require (
    github.com/lib/pq v1.10.9           // PostgreSQL –¥—Ä–∞–π–≤–µ—Ä
    golang.org/x/crypto v0.14.0         // bcrypt –¥–ª—è –ø–∞—Ä–æ–ª–µ–π
)
```

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **–Ø–∑—ã–∫:** Go 1.21
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** PostgreSQL 15
- **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è:** Docker, Docker Compose
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** bcrypt, prepared statements, mutex locks

## üìä –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü—É `operations`:
- –¢–∏–ø –æ–ø–µ—Ä–∞—Ü–∏–∏ (create, read, delete, etc.)
- –í—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ç–∫–∞
- ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ID —Ñ–∞–π–ª–∞ (–µ—Å–ª–∏ –ø—Ä–∏–º–µ–Ω–∏–º–æ)

–ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ —á–µ—Ä–µ–∑ SQL:
```sql
SELECT o.timestamp, o.operation_type, u.username, f.filename
FROM operations o
JOIN users u ON o.user_id = u.id
LEFT JOIN files f ON o.file_id = f.id
ORDER BY o.timestamp DESC;
```

## üîç –û—Ç–ª–∞–¥–∫–∞

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL
```bash
docker exec -it secure-fm-db psql -U postgres -d securefm
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```bash
docker logs secure-fm-app
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –ë–î
```bash
docker logs secure-fm-db
```

## ‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ä–∞—Å–ø–∞–∫–æ–≤–∞–Ω–Ω–æ–≥–æ ZIP: 100 MB
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π compression ratio: 100:1
- –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –ø–∞—Ä–æ–ª—è: 8 —Å–∏–º–≤–æ–ª–æ–≤
- –í—Å–µ —Ñ–∞–π–ª—ã –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã sandbox-–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–µ–π

## üéì –û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ —Ü–µ–ª–∏

–ü—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç:
1. –ó–∞—â–∏—Ç—É –æ—Ç OWASP Top 10 —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
2. –ë–µ–∑–æ–ø–∞—Å–Ω—É—é —Ä–∞–±–æ—Ç—É —Å —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π
3. –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ë–î (prepared statements)
4. –ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω—É—é –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (race conditions)
5. –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
6. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∞—É–¥–∏—Ç –¥–µ–π—Å—Ç–≤–∏–π

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã

- [OWASP Cheat Sheet Series](https://cheatsheetseries.owasp.org/)
- [Go Security Best Practices](https://golang.org/doc/security/)
- [PostgreSQL Security](https://www.postgresql.org/docs/current/security.html)


